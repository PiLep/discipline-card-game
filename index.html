<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Cartes sur table</title>

    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#1a0f0a">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Cartes sur table">
    <link rel="icon" type="image/png" href="images/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/svg+xml" href="images/favicon.svg">
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="images/apple-touch-icon.png">
    <link rel="manifest" href="images/site.webmanifest">

    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <div class="app">
        <!-- Header -->
        <header class="header">
            <img src="images/logo.png" alt="Cartes sur table" class="logo">
        </header>

        <!-- Calendrier compact -->
        <section class="calendar-section">
            <div class="calendar-header">
                <button class="nav-btn" id="prev-week">&larr;</button>
                <span class="week-label" id="week-label"></span>
                <button class="nav-btn" id="next-week">&rarr;</button>
            </div>
            <div class="calendar-grid" id="calendar-grid"></div>
        </section>

        <!-- Zone de jeu principale -->
        <section class="game-board">
            <!-- Date sélectionnée -->
            <h2 class="selected-date-title" id="selected-date-title">Aujourd'hui</h2>

            <!-- Zones de drop pour les repas -->
            <div class="meal-slots">
                <div class="meal-drop-zone" data-meal="breakfast" id="drop-breakfast">
                    <div class="meal-label">Petit-déj</div>
                    <div class="meal-card-slot" id="slot-breakfast"></div>
                </div>
                <div class="meal-drop-zone main-meal" data-meal="lunch" id="drop-lunch">
                    <div class="meal-label">Déjeuner</div>
                    <div class="meal-card-slot" id="slot-lunch"></div>
                </div>
                <div class="meal-drop-zone main-meal" data-meal="dinner" id="drop-dinner">
                    <div class="meal-label">Dîner</div>
                    <div class="meal-card-slot" id="slot-dinner"></div>
                </div>
            </div>
        </section>

        <!-- Main de cartes (style Hearthstone) -->
        <section class="hand-section">
            <div class="hand-info">
                <span id="deck-info"></span>
            </div>
            <div class="card-hand" id="card-hand">
                <!-- Les cartes seront générées ici -->
            </div>
        </section>

        <!-- Bouton paramètres -->
        <button class="settings-toggle" id="settings-toggle">☰</button>

        <!-- Panel paramètres -->
        <div class="settings-panel" id="settings-panel">
            <div class="settings-content">
                <h2>Régime</h2>
                <div class="regime-selector" id="regime-selector"></div>
                <div class="custom-deck" id="custom-deck" style="display: none;">
                    <h3>Deck personnalisé</h3>
                    <div class="custom-inputs">
                        <label>Discipline <input type="number" id="custom-discipline" min="0" max="21" value="10"></label>
                        <label>Flex <input type="number" id="custom-flex" min="0" max="21" value="8"></label>
                        <label>Joker <input type="number" id="custom-joker" min="0" max="21" value="3"></label>
                    </div>
                    <button class="save-custom-btn" id="save-custom">Appliquer</button>
                </div>
                <div class="theme-toggle">
                    <label class="toggle-label">
                        <span>Mode sombre</span>
                        <input type="checkbox" id="dark-mode-toggle">
                        <span class="toggle-switch"></span>
                    </label>
                </div>
                <button class="close-settings" id="close-settings">Fermer</button>
            </div>
        </div>

        <!-- Toast notifications -->
        <div class="toast" id="toast"></div>

        <!-- Onboarding -->
        <div class="onboarding" id="onboarding">
            <div class="onboarding-content">
                <!-- Step 1: Welcome -->
                <div class="onboarding-step" data-step="1">
                    <img src="images/logo.png" alt="Cartes sur table" class="onboarding-logo">
                    <h2>Bienvenue !</h2>
                    <p class="onboarding-text">
                        <strong>Cartes sur table</strong> t'aide a planifier tes repas de la semaine avec un systeme de cartes.
                    </p>
                    <p class="onboarding-text">
                        Chaque semaine, tu recois un deck de cartes a repartir sur tes repas selon ton objectif nutritionnel.
                    </p>
                    <button class="onboarding-btn" data-next="2">Continuer</button>
                </div>

                <!-- Step 2: Cards explanation -->
                <div class="onboarding-step" data-step="2" style="display: none;">
                    <h2>Les cartes</h2>
                    <div class="onboarding-cards">
                        <div class="onboarding-card-info">
                            <span class="card-dot discipline"></span>
                            <div>
                                <strong>Discipline</strong>
                                <p>Repas sain, conforme a ton regime</p>
                            </div>
                        </div>
                        <div class="onboarding-card-info">
                            <span class="card-dot flex"></span>
                            <div>
                                <strong>Flex</strong>
                                <p>Ecart controle, repas plaisir</p>
                            </div>
                        </div>
                        <div class="onboarding-card-info">
                            <span class="card-dot joker"></span>
                            <div>
                                <strong>Joker</strong>
                                <p>Liberte totale, sans culpabilite</p>
                            </div>
                        </div>
                    </div>
                    <button class="onboarding-btn" data-next="3">Continuer</button>
                </div>

                <!-- Step 3: Regime selection -->
                <div class="onboarding-step" data-step="3" style="display: none;">
                    <h2>Choisis ton mode</h2>
                    <p class="onboarding-text">Selectionne le regime qui correspond a tes objectifs :</p>
                    <div class="onboarding-regimes" id="onboarding-regimes"></div>
                    <button class="onboarding-btn" data-next="4" id="onboarding-regime-btn" disabled>Continuer</button>
                </div>

                <!-- Step 4: How to play -->
                <div class="onboarding-step" data-step="4" style="display: none;">
                    <h2>Comment jouer</h2>
                    <div class="onboarding-tuto">
                        <div class="tuto-step">
                            <span class="tuto-number">1</span>
                            <p>Selectionne un jour dans le calendrier</p>
                        </div>
                        <div class="tuto-step">
                            <span class="tuto-number">2</span>
                            <p>Glisse une carte sur un repas (petit-dej, dejeuner, diner)</p>
                        </div>
                        <div class="tuto-step">
                            <span class="tuto-number">3</span>
                            <p>Gere ton deck pour tenir toute la semaine !</p>
                        </div>
                    </div>
                    <button class="onboarding-btn onboarding-start" id="onboarding-finish">C'est parti !</button>
                </div>
            </div>
        </div>
    </div>

    <script src="js/cards-data.js"></script>
    <script src="js/game.js"></script>
    <script src="js/app.js"></script>
    <script>
        // PWA Service Worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/sw.js')
                .catch(err => console.log('SW:', err));
        }
    </script>
</body>
</html>
